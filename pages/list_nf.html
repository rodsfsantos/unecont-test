<!-- Lista de Notas Fiscais -->
<div class="p-8 fade-in">
    <!-- Filter Section -->
    <div class="mb-8">
        <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Filtros</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Filter by Issue Month -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">MÃªs de EmissÃ£o</label>
                    <select id="filter-issue-month"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            onchange="filterTable()">
                        <option value="">Todos os meses</option>
                        <option value="12">Dezembro</option>
                        <option value="11">Novembro</option>
                        <option value="10">Outubro</option>
                    </select>
                </div>

                <!-- Filter by Charge Month -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">MÃªs de CobranÃ§a</label>
                    <select id="filter-charge-month"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            onchange="filterTable()">
                        <option value="">Todos os meses</option>
                        <option value="12">Dezembro</option>
                        <option value="11">Novembro</option>
                        <option value="10">Outubro</option>
                    </select>
                </div>

                <!-- Filter by Payment Month -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">MÃªs de Pagamento</label>
                    <select id="filter-payment-month"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            onchange="filterTable()">
                        <option value="">Todos os meses</option>
                        <option value="12">Dezembro</option>
                        <option value="11">Novembro</option>
                        <option value="10">Outubro</option>
                    </select>
                </div>

                <!-- Filter by Status -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
                    <select id="filter-status"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                            onchange="filterTable()">
                        <option value="">Todos os status</option>
                        <option value="Emitida">Emitida</option>
                        <option value="CobranÃ§a realizada">CobranÃ§a realizada</option>
                        <option value="Pagamento em atraso">Pagamento em atraso</option>
                        <option value="Pagamento realizado">Pagamento realizado</option>
                    </select>
                </div>
            </div>
            <button class="mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium"
                    onclick="resetFilters()">
                Limpar Filtros
            </button>
        </div>
    </div>

    <!-- Table Section -->
    <div class="bg-white rounded-lg shadow overflow-hidden">
        <div class="overflow-x-auto">
            <table class="w-full" id="invoices-table">
                <thead class="bg-gray-50 border-b border-gray-200">
                    <tr>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider">ID</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider">Pagador</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider">Data EmissÃ£o</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider">Data CobranÃ§a</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider">Data Pagamento</th>
                        <th class="px-6 py-4 text-right text-xs font-semibold text-gray-900 uppercase tracking-wider">Valor</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider">Status</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider">NF</th>
                        <th class="px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider">Boleto</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200" id="table-body">
                    <!-- Rows will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
        <div class="px-6 py-4 bg-gray-50 border-t border-gray-200 text-sm text-gray-600">
            Mostrando <span id="row-count">0</span> notas fiscais
        </div>
    </div>
</div>

<script>
    // Status colors
    const statusColors = {
        'Emitida': { bg: 'bg-blue-100', text: 'text-blue-800' },
        'CobranÃ§a realizada': { bg: 'bg-yellow-100', text: 'text-yellow-800' },
        'Pagamento em atraso': { bg: 'bg-red-100', text: 'text-red-800' },
        'Pagamento realizado': { bg: 'bg-green-100', text: 'text-green-800' }
    };

    function renderTable(invoices) {
        const tableBody = document.getElementById('table-body');
        const rowCount = document.getElementById('row-count');
        
        tableBody.innerHTML = '';
        
        invoices.forEach(invoice => {
            const colors = statusColors[invoice.status] || { bg: 'bg-gray-100', text: 'text-gray-800' };
            const row = document.createElement('tr');
            row.className = 'hover:bg-gray-50 transition invoice-row';
            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600">${invoice.id}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${invoice.payer}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${formatDate(invoice.issueDate)}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${formatDate(invoice.chargeDate)}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-600">${invoice.paymentDate ? formatDate(invoice.paymentDate) : '-'}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 text-right">R$ ${formatCurrency(invoice.amount)}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${colors.bg} ${colors.text}">
                        ${invoice.status}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    <button class="text-blue-600 hover:text-blue-900 font-medium" onclick="downloadDocument('${invoice.invoiceDoc}')">
                        ðŸ“„ ${invoice.invoiceDoc}
                    </button>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm">
                    <button class="text-blue-600 hover:text-blue-900 font-medium" onclick="downloadDocument('${invoice.boletoDoc}')">
                        ðŸ“‹ ${invoice.boletoDoc}
                    </button>
                </td>
            `;
            tableBody.appendChild(row);
        });
        
        rowCount.textContent = invoices.length;
    }

    function formatDate(dateString) {
        const [year, month, day] = dateString.split('-');
        return `${day}/${month}/${year}`;
    }

    function formatCurrency(value) {
        return value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function downloadDocument(docName) {
        alert(`Documento "${docName}" seria baixado aqui. (SimulaÃ§Ã£o)`);
    }

    function filterTable() {
        const issueMonth = document.getElementById('filter-issue-month').value;
        const chargeMonth = document.getElementById('filter-charge-month').value;
        const paymentMonth = document.getElementById('filter-payment-month').value;
        const status = document.getElementById('filter-status').value;

        let filtered = window.mockData.invoices.filter(invoice => {
            const invoiceIssueMonth = invoice.issueDate.split('-')[1];
            const invoiceChargeMonth = invoice.chargeDate.split('-')[1];
            const invoicePaymentMonth = invoice.paymentDate ? invoice.paymentDate.split('-')[1] : null;

            if (issueMonth && invoiceIssueMonth !== issueMonth) return false;
            if (chargeMonth && invoiceChargeMonth !== chargeMonth) return false;
            if (paymentMonth && invoicePaymentMonth !== paymentMonth) return false;
            if (status && invoice.status !== status) return false;

            return true;
        });

        renderTable(filtered);
    }

    function resetFilters() {
        document.getElementById('filter-issue-month').value = '';
        document.getElementById('filter-charge-month').value = '';
        document.getElementById('filter-payment-month').value = '';
        document.getElementById('filter-status').value = '';
        renderTable(window.mockData.invoices);
    }

    // Initial render
    setTimeout(() => {
        renderTable(window.mockData.invoices);
    }, 100);
</script>
